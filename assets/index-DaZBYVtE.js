import{g as Ke,r as y,C as Ge,q as Ze,o as be,w as Ve,ax as De,aw as me,ay as he,A as p,aA as Je,aE as Ye,aF as Qe,a5 as Xe,aG as er,s as B,aH as rr,aI as tr,a6 as nr,aJ as ar,aK as ye}from"./index-BO5UqqYm.js";import{a as Pe,D as sr,A as or,L as pe,b as ur,T as ir,S as cr,F as lr}from"./index-CF2cwRL8.js";import{M as dr}from"./MenuConext-2gqVLFCC.js";import{m as Ie,M as fr}from"./Dropdown-DhUqZZ99.js";var ee,_e;function hr(){if(_e)return ee;_e=1;function e(r,t,n,i){var u=-1,f=r==null?0:r.length;for(i&&f&&(n=r[++u]);++u<f;)n=t(n,r[u],u,r);return n}return ee=e,ee}var re,we;function pr(){if(we)return re;we=1;function e(r){return function(t){return r==null?void 0:r[t]}}return re=e,re}var te,Ce;function gr(){if(Ce)return te;Ce=1;var e=pr(),r={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},t=e(r);return te=t,te}var ne,je;function xr(){if(je)return ne;je=1;var e=gr(),r=Pe(),t=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,n="\\u0300-\\u036f",i="\\ufe20-\\ufe2f",u="\\u20d0-\\u20ff",f=n+i+u,h="["+f+"]",b=RegExp(h,"g");function j(v){return v=r(v),v&&v.replace(t,e).replace(b,"")}return ne=j,ne}var ae,Se;function mr(){if(Se)return ae;Se=1;var e=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;function r(t){return t.match(e)||[]}return ae=r,ae}var se,Ee;function vr(){if(Ee)return se;Ee=1;var e=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;function r(t){return e.test(t)}return se=r,se}var oe,Oe;function br(){if(Oe)return oe;Oe=1;var e="\\ud800-\\udfff",r="\\u0300-\\u036f",t="\\ufe20-\\ufe2f",n="\\u20d0-\\u20ff",i=r+t+n,u="\\u2700-\\u27bf",f="a-z\\xdf-\\xf6\\xf8-\\xff",h="\\xac\\xb1\\xd7\\xf7",b="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",j="\\u2000-\\u206f",v=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",_="A-Z\\xc0-\\xd6\\xd8-\\xde",S="\\ufe0e\\ufe0f",A=h+b+j+v,k="['’]",D="["+A+"]",P="["+i+"]",m="\\d+",N="["+u+"]",q="["+f+"]",W="[^"+e+A+m+u+f+_+"]",Y="\\ud83c[\\udffb-\\udfff]",Q="(?:"+P+"|"+Y+")",o="[^"+e+"]",s="(?:\\ud83c[\\udde6-\\uddff]){2}",a="[\\ud800-\\udbff][\\udc00-\\udfff]",d="["+_+"]",c="\\u200d",l="(?:"+q+"|"+W+")",x="(?:"+d+"|"+W+")",g="(?:"+k+"(?:d|ll|m|re|s|t|ve))?",w="(?:"+k+"(?:D|LL|M|RE|S|T|VE))?",C=Q+"?",O="["+S+"]?",R="(?:"+c+"(?:"+[o,s,a].join("|")+")"+O+C+")*",T="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",$="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",L=O+C+R,X="(?:"+[N,s,a].join("|")+")"+L,We=RegExp([d+"?"+q+"+"+g+"(?="+[D,d,"$"].join("|")+")",x+"+"+w+"(?="+[D,d+l,"$"].join("|")+")",d+"?"+l+"+"+g,d+"+"+w,$,T,m,X].join("|"),"g");function Be(Fe){return Fe.match(We)||[]}return oe=Be,oe}var ue,Re;function yr(){if(Re)return ue;Re=1;var e=mr(),r=vr(),t=Pe(),n=br();function i(u,f,h){return u=t(u),f=h?void 0:f,f===void 0?r(u)?n(u):e(u):u.match(f)||[]}return ue=i,ue}var ie,Te;function _r(){if(Te)return ie;Te=1;var e=hr(),r=xr(),t=yr(),n="['’]",i=RegExp(n,"g");function u(f){return function(h){return e(t(r(h).replace(i,"")),f,"")}}return ie=u,ie}var ce,$e;function wr(){if($e)return ce;$e=1;var e=_r(),r=e(function(t,n,i){return t+(i?"-":"")+n.toLowerCase()});return ce=r,ce}var Cr=wr();const jr=Ke(Cr);var Sr=["primary","primaryActive","primaryBg","primaryBgHover","primaryHover","primaryBorder","primaryBorderSecondary","error","errorActive","errorBg","errorBgHover","errorHover","errorBorder","errorBorderSecondary","success","successActive","successBg","successBgHover","successHover","successBorder","successBorderSecondary","warning","warningActive","warningBg","warningBgHover","warningHover","warningBorder","warningBorderSecondary","container","elevated","mask","spotlight","border","borderSecondary","fill","fillQuaternary","fillSecondary","fillTertiary","text","textQuaternary","textSecondary","textTertiary"],le=function(r){var t=getComputedStyle(r??document.documentElement),n=t.getPropertyValue("color-scheme").trim();return Sr.reduce(function(i,u){var f=t.getPropertyValue("--".concat(jr(u))).trim();return be(be({},i),{},Ve({},u,f))},{isDark:n==="dark"})};function Er(){var e=y.useContext(Ge),r=e.theme,t=e.themeTarget,n=y.useState(function(){return le(t==null?void 0:t.current)}),i=Ze(n,2),u=i[0],f=i[1];return y.useEffect(function(){setTimeout(function(){f(le(t==null?void 0:t.current))},0);var h=window.matchMedia("(prefers-color-scheme: dark)"),b=function(){f(le(t==null?void 0:t.current))};return r==="system"&&h.addEventListener("change",b),function(){h.removeEventListener("change",b)}},[r]),u}function ge(){return ge=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},ge.apply(this,arguments)}var Or=y.forwardRef(function(e,r){return y.createElement("svg",ge({ref:r,xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor",strokeWidth:1.5,"aria-hidden":"true","data-slot":"icon",viewBox:"0 0 24 24",width:"1em",height:"1em"},e,{className:"metis-icon".concat(e.className?" ".concat(e.className):"")}),y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.636 5.636a9 9 0 1 0 12.728 0M12 3v9"}))});function xe(){return xe=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},xe.apply(this,arguments)}var Rr=y.forwardRef(function(e,r){return y.createElement("svg",xe({ref:r,xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"none",viewBox:"0 0 24 24"},e,{className:"metis-icon".concat(e.className?" ".concat(e.className):"")}),y.createElement("path",{fill:"currentColor",d:"M8.202 4.8c-.542.005-.985.015-1.364.046-.463.037-.791.101-1.051.194l-.24.103a3.2 3.2 0 0 0-1.277 1.18l-.123.22c-.15.296-.247.673-.297 1.29-.052.628-.052 1.43-.052 2.563v3.196c0 1.133 0 1.935.052 2.562.05.618.146.995.297 1.292l.123.22c.308.502.75.91 1.276 1.179l.24.103c.26.093.589.157 1.052.194.379.032.822.041 1.363.046zm13.596 8.793c0 1.106 0 1.984-.057 2.691-.052.627-.151 1.173-.366 1.674l-.1.212a4.8 4.8 0 0 1-1.767 1.912l-.33.185c-.56.285-1.17.407-1.886.466-.707.058-1.585.057-2.692.057H9.4c-1.107 0-1.985 0-2.692-.057-.627-.052-1.172-.152-1.674-.367l-.212-.099A4.8 4.8 0 0 1 2.91 18.5l-.185-.33c-.285-.559-.407-1.17-.466-1.886-.057-.707-.057-1.585-.057-2.691v-3.197c0-1.107 0-1.985.057-2.692.059-.716.181-1.327.466-1.886l.185-.33A4.8 4.8 0 0 1 4.822 3.72l.212-.1c.501-.215 1.047-.314 1.674-.366.707-.057 1.585-.057 2.692-.057h5.2c1.107 0 1.985 0 2.692.057.716.059 1.327.181 1.886.466l.33.185a4.8 4.8 0 0 1 1.767 1.912l.1.212c.215.501.314 1.047.366 1.674.057.707.057 1.585.057 2.692zM9.797 19.194H14.6c1.133 0 1.935 0 2.562-.052.618-.05.995-.146 1.291-.297l.22-.123c.503-.308.911-.75 1.18-1.276l.103-.24c.093-.26.157-.589.194-1.052.052-.627.052-1.429.052-2.562v-3.196c0-1.133 0-1.935-.052-2.562-.037-.463-.101-.791-.194-1.051l-.103-.24a3.2 3.2 0 0 0-1.18-1.277l-.22-.123c-.296-.15-.673-.247-1.29-.297-.628-.052-1.43-.052-2.563-.052H9.797l.001.006z"}))}),Tr=typeof global=="object"&&global&&global.Object===Object&&global,$r=typeof self=="object"&&self&&self.Object===Object&&self,Z=Tr||$r||Function("return this")(),F=Z.Symbol,Ue=Object.prototype,Ar=Ue.hasOwnProperty,Nr=Ue.toString,z=F?F.toStringTag:void 0;function Mr(e){var r=Ar.call(e,z),t=e[z];try{e[z]=void 0;var n=!0}catch{}var i=Nr.call(e);return n&&(r?e[z]=t:delete e[z]),i}var kr=Object.prototype,Dr=kr.toString;function Pr(e){return Dr.call(e)}var Ir="[object Null]",Ur="[object Undefined]",Ae=F?F.toStringTag:void 0;function Lr(e){return e==null?e===void 0?Ur:Ir:Ae&&Ae in Object(e)?Mr(e):Pr(e)}function Le(e){var r=typeof e;return e!=null&&(r=="object"||r=="function")}var zr="[object AsyncFunction]",Hr="[object Function]",qr="[object GeneratorFunction]",Wr="[object Proxy]";function Br(e){if(!Le(e))return!1;var r=Lr(e);return r==Hr||r==qr||r==zr||r==Wr}var de=Z["__core-js_shared__"],Ne=function(){var e=/[^.]+$/.exec(de&&de.keys&&de.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function Fr(e){return!!Ne&&Ne in e}var Kr=Function.prototype,Gr=Kr.toString;function Zr(e){if(e!=null){try{return Gr.call(e)}catch{}try{return e+""}catch{}}return""}var Vr=/[\\^$.*+?()[\]{}|]/g,Jr=/^\[object .+?Constructor\]$/,Yr=Function.prototype,Qr=Object.prototype,Xr=Yr.toString,et=Qr.hasOwnProperty,rt=RegExp("^"+Xr.call(et).replace(Vr,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function tt(e){if(!Le(e)||Fr(e))return!1;var r=Br(e)?rt:Jr;return r.test(Zr(e))}function nt(e,r){return e==null?void 0:e[r]}function ve(e,r){var t=nt(e,r);return tt(t)?t:void 0}function at(){}function st(e,r,t,n){for(var i=e.length,u=t+-1;++u<i;)if(r(e[u],u,e))return u;return-1}function ot(e){return e!==e}function ut(e,r,t){for(var n=t-1,i=e.length;++n<i;)if(e[n]===r)return n;return-1}function it(e,r,t){return r===r?ut(e,r,t):st(e,ot,t)}function ct(e,r){var t=e==null?0:e.length;return!!t&&it(e,r,0)>-1}function lt(e,r){return e===r||e!==e&&r!==r}var H=ve(Object,"create");function dt(){this.__data__=H?H(null):{},this.size=0}function ft(e){var r=this.has(e)&&delete this.__data__[e];return this.size-=r?1:0,r}var ht="__lodash_hash_undefined__",pt=Object.prototype,gt=pt.hasOwnProperty;function xt(e){var r=this.__data__;if(H){var t=r[e];return t===ht?void 0:t}return gt.call(r,e)?r[e]:void 0}var mt=Object.prototype,vt=mt.hasOwnProperty;function bt(e){var r=this.__data__;return H?r[e]!==void 0:vt.call(r,e)}var yt="__lodash_hash_undefined__";function _t(e,r){var t=this.__data__;return this.size+=this.has(e)?0:1,t[e]=H&&r===void 0?yt:r,this}function M(e){var r=-1,t=e==null?0:e.length;for(this.clear();++r<t;){var n=e[r];this.set(n[0],n[1])}}M.prototype.clear=dt;M.prototype.delete=ft;M.prototype.get=xt;M.prototype.has=bt;M.prototype.set=_t;function wt(){this.__data__=[],this.size=0}function V(e,r){for(var t=e.length;t--;)if(lt(e[t][0],r))return t;return-1}var Ct=Array.prototype,jt=Ct.splice;function St(e){var r=this.__data__,t=V(r,e);if(t<0)return!1;var n=r.length-1;return t==n?r.pop():jt.call(r,t,1),--this.size,!0}function Et(e){var r=this.__data__,t=V(r,e);return t<0?void 0:r[t][1]}function Ot(e){return V(this.__data__,e)>-1}function Rt(e,r){var t=this.__data__,n=V(t,e);return n<0?(++this.size,t.push([e,r])):t[n][1]=r,this}function I(e){var r=-1,t=e==null?0:e.length;for(this.clear();++r<t;){var n=e[r];this.set(n[0],n[1])}}I.prototype.clear=wt;I.prototype.delete=St;I.prototype.get=Et;I.prototype.has=Ot;I.prototype.set=Rt;var Tt=ve(Z,"Map");function $t(){this.size=0,this.__data__={hash:new M,map:new(Tt||I),string:new M}}function At(e){var r=typeof e;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?e!=="__proto__":e===null}function J(e,r){var t=e.__data__;return At(r)?t[typeof r=="string"?"string":"hash"]:t.map}function Nt(e){var r=J(this,e).delete(e);return this.size-=r?1:0,r}function Mt(e){return J(this,e).get(e)}function kt(e){return J(this,e).has(e)}function Dt(e,r){var t=J(this,e),n=t.size;return t.set(e,r),this.size+=t.size==n?0:1,this}function U(e){var r=-1,t=e==null?0:e.length;for(this.clear();++r<t;){var n=e[r];this.set(n[0],n[1])}}U.prototype.clear=$t;U.prototype.delete=Nt;U.prototype.get=Mt;U.prototype.has=kt;U.prototype.set=Dt;var fe=ve(Z,"Set"),Pt="__lodash_hash_undefined__";function It(e){return this.__data__.set(e,Pt),this}function Ut(e){return this.__data__.has(e)}function K(e){var r=-1,t=e==null?0:e.length;for(this.__data__=new U;++r<t;)this.add(e[r])}K.prototype.add=K.prototype.push=It;K.prototype.has=Ut;function Lt(e,r){return e.has(r)}function ze(e){var r=-1,t=Array(e.size);return e.forEach(function(n){t[++r]=n}),t}var zt=1/0,Ht=fe&&1/ze(new fe([,-0]))[1]==zt?function(e){return new fe(e)}:at,qt=200;function Wt(e,r,t){var n=-1,i=ct,u=e.length,f=!0,h=[],b=h;if(u>=qt){var j=Ht(e);if(j)return ze(j);f=!1,i=Lt,b=new K}else b=h;e:for(;++n<u;){var v=e[n],_=v;if(v=v!==0?v:0,f&&_===_){for(var S=b.length;S--;)if(b[S]===_)continue e;h.push(v)}else i(b,_,t)||(b!==h&&b.push(_),h.push(v))}return h}function Bt(e){return e&&e.length?Wt(e):[]}const Ft=()=>{const e=De(),{t:r}=me(),t=he(f=>f.currentUser),n=he(f=>f.clearCurrentUser),i=async f=>{const{key:h}=f;h==="logout"?(await Qe(),Xe.flushSync(()=>{n(),e(er)})):e(`/account/${h}`)},u=[{key:"center",icon:p.jsx(Je,{}),label:r("navbar.account.center")},{key:"settings",icon:p.jsx(Ye,{}),label:r("navbar.account.settings")},{type:"divider"},{key:"logout",icon:p.jsx(Or,{}),label:r("navbar.logout")}];return p.jsx(sr,{menu:{selectedKeys:[],onClick:i,items:u},placement:"bottomLeft",children:p.jsxs("div",{className:"flex cursor-pointer items-center gap-2 font-medium",children:[p.jsx(or,{size:32,src:t==null?void 0:t.avatar}),p.jsx("span",{children:t.name})]})})},Kt=({className:e})=>{const{t:r,i18n:t}=me(),n=t.language==="zh-CN",i=y.useCallback(()=>{t.changeLanguage(n?"en-US":"zh-CN")},[t,n]);return p.jsx(Ie,{title:r("lang.tips.switch"),children:p.jsxs("button",{className:B("group relative size-6",e),onClick:i,children:[p.jsx("span",{className:B("border-border-secondary absolute flex size-5 items-center justify-center rounded-[1px] text-base",{"group-hover:bg-text top-1 z-1 origin-[0_0] scale-70 bg-black/60 text-white dark:bg-gray-400 dark:text-gray-950":n,"group-hover:border-text bottom-0.5 z-0 origin-[100%_100%] scale-55 border border-black/60 dark:border-gray-400":!n}),children:"中"}),p.jsx("span",{className:B("border-border-secondary absolute flex size-5 items-center justify-center rounded-[1px] text-base",{"group-hover:bg-text top-1 z-1 origin-[0_0] scale-70 bg-black/60 text-white dark:bg-gray-400 dark:text-gray-950":!n,"group-hover:border-text bottom-0.5 z-0 origin-[100%_100%] scale-55 border border-black/60 dark:border-gray-400":n}),children:"En"})]},"lang-button")})};var E={},Me;function Gt(){if(Me)return E;Me=1,Object.defineProperty(E,"__esModule",{value:!0}),E.TokenData=void 0,E.parse=_,E.compile=S,E.match=D,E.pathToRegexp=P,E.stringify=W;const e="/",r=o=>o,t=/^[$_\p{ID_Start}]$/u,n=/^[$\u200c\u200d\p{ID_Continue}]$/u,i="https://git.new/pathToRegexpError",u={"{":"{","}":"}","(":"(",")":")","[":"[","]":"]","+":"+","?":"?","!":"!"};function f(o){return o.replace(/[{}()\[\]+?!:*]/g,"\\$&")}function h(o){return o.replace(/[.+*?^${}()[\]|/\\]/g,"\\$&")}function*b(o){const s=[...o];let a=0;function d(){let c="";if(t.test(s[++a]))for(c+=s[a];n.test(s[++a]);)c+=s[a];else if(s[a]==='"'){let l=a;for(;a<s.length;){if(s[++a]==='"'){a++,l=0;break}s[a]==="\\"?c+=s[++a]:c+=s[a]}if(l)throw new TypeError(`Unterminated quote at ${l}: ${i}`)}if(!c)throw new TypeError(`Missing parameter name at ${a}: ${i}`);return c}for(;a<s.length;){const c=s[a],l=u[c];if(l)yield{type:l,index:a++,value:c};else if(c==="\\")yield{type:"ESCAPED",index:a++,value:s[a++]};else if(c===":"){const x=d();yield{type:"PARAM",index:a,value:x}}else if(c==="*"){const x=d();yield{type:"WILDCARD",index:a,value:x}}else yield{type:"CHAR",index:a,value:s[a++]}}return{type:"END",index:a,value:""}}class j{constructor(s){this.tokens=s}peek(){if(!this._peek){const s=this.tokens.next();this._peek=s.value}return this._peek}tryConsume(s){const a=this.peek();if(a.type===s)return this._peek=void 0,a.value}consume(s){const a=this.tryConsume(s);if(a!==void 0)return a;const{type:d,index:c}=this.peek();throw new TypeError(`Unexpected ${d} at ${c}, expected ${s}: ${i}`)}text(){let s="",a;for(;a=this.tryConsume("CHAR")||this.tryConsume("ESCAPED");)s+=a;return s}}class v{constructor(s){this.tokens=s}}E.TokenData=v;function _(o,s={}){const{encodePath:a=r}=s,d=new j(b(o));function c(x){const g=[];for(;;){const w=d.text();w&&g.push({type:"text",value:a(w)});const C=d.tryConsume("PARAM");if(C){g.push({type:"param",name:C});continue}const O=d.tryConsume("WILDCARD");if(O){g.push({type:"wildcard",name:O});continue}if(d.tryConsume("{")){g.push({type:"group",tokens:c("}")});continue}return d.consume(x),g}}const l=c("END");return new v(l)}function S(o,s={}){const{encode:a=encodeURIComponent,delimiter:d=e}=s,c=o instanceof v?o:_(o,s),l=A(c.tokens,d,a);return function(g={}){const[w,...C]=l(g);if(C.length)throw new TypeError(`Missing parameters: ${C.join(", ")}`);return w}}function A(o,s,a){const d=o.map(c=>k(c,s,a));return c=>{const l=[""];for(const x of d){const[g,...w]=x(c);l[0]+=g,l.push(...w)}return l}}function k(o,s,a){if(o.type==="text")return()=>[o.value];if(o.type==="group"){const c=A(o.tokens,s,a);return l=>{const[x,...g]=c(l);return g.length?[""]:[x]}}const d=a||r;return o.type==="wildcard"&&a!==!1?c=>{const l=c[o.name];if(l==null)return["",o.name];if(!Array.isArray(l)||l.length===0)throw new TypeError(`Expected "${o.name}" to be a non-empty array`);return[l.map((x,g)=>{if(typeof x!="string")throw new TypeError(`Expected "${o.name}/${g}" to be a string`);return d(x)}).join(s)]}:c=>{const l=c[o.name];if(l==null)return["",o.name];if(typeof l!="string")throw new TypeError(`Expected "${o.name}" to be a string`);return[d(l)]}}function D(o,s={}){const{decode:a=decodeURIComponent,delimiter:d=e}=s,{regexp:c,keys:l}=P(o,s),x=l.map(g=>a===!1?r:g.type==="param"?a:w=>w.split(d).map(a));return function(w){const C=c.exec(w);if(!C)return!1;const O=C[0],R=Object.create(null);for(let T=1;T<C.length;T++){if(C[T]===void 0)continue;const $=l[T-1],L=x[T-1];R[$.name]=L(C[T])}return{path:O,params:R}}}function P(o,s={}){const{delimiter:a=e,end:d=!0,sensitive:c=!1,trailing:l=!0}=s,x=[],g=[],w=c?"":"i",O=(Array.isArray(o)?o:[o]).map($=>$ instanceof v?$:_($,s));for(const{tokens:$}of O)for(const L of m($,0,[])){const X=N(L,a,x);g.push(X)}let R=`^(?:${g.join("|")})`;return l&&(R+=`(?:${h(a)}$)?`),R+=d?"$":`(?=${h(a)}|$)`,{regexp:new RegExp(R,w),keys:x}}function*m(o,s,a){if(s===o.length)return yield a;const d=o[s];if(d.type==="group"){const c=a.slice();for(const l of m(d.tokens,0,c))yield*m(o,s+1,l)}else a.push(d);yield*m(o,s+1,a)}function N(o,s,a){let d="",c="",l=!0;for(let x=0;x<o.length;x++){const g=o[x];if(g.type==="text"){d+=h(g.value),c+=g.value,l||(l=g.value.includes(s));continue}if(g.type==="param"||g.type==="wildcard"){if(!l&&!c)throw new TypeError(`Missing text after "${g.name}": ${i}`);g.type==="param"?d+=`(${q(s,l?"":c)}+)`:d+="([\\s\\S]+)",a.push(g),c="",l=!1;continue}}return d}function q(o,s){return s.length<2?o.length<2?`[^${h(o+s)}]`:`(?:(?!${h(o)})[^${h(s)}])`:o.length<2?`(?:(?!${h(s)})[^${h(o)}])`:`(?:(?!${h(s)}|${h(o)})[\\s\\S])`}function W(o){return o.tokens.map(function s(a,d,c){if(a.type==="text")return f(a.value);if(a.type==="group")return`{${a.tokens.map(s).join("")}}`;const x=Y(a.name)&&Q(c[d+1])?a.name:JSON.stringify(a.name);if(a.type==="param")return`:${x}`;if(a.type==="wildcard")return`*${x}`;throw new TypeError(`Unexpected token: ${a}`)}).join("")}function Y(o){const[s,...a]=o;return t.test(s)?a.every(d=>n.test(d)):!1}function Q(o){return(o==null?void 0:o.type)!=="text"?!0:!n.test(o.value[0])}return E}var Zt=Gt();function Vt(e="/",r="/"){return(e||r).startsWith("/")?e:`/${r}/${e}`.replace(/\/\//g,"/").replace(/\/\//g,"/")}function He(e){return e.split("?")[0].split("#")[0]}function G({data:e,t:r,userPerms:t},n="/",i=!1){return e.filter(u=>!(!i&&u.hideInMenu||u.permission&&!rr(u.permission,t))).flatMap(u=>{const f=Vt(u.path,n);if(!u.name)return u.children?G({data:u.children,t:r,userPerms:t},f,i):[];let h;if(u.children){const j=G({data:u.children,t:r,userPerms:t},f,i);j.length>0&&(h=j)}return[{key:f,label:r(u.name),icon:u.icon,...h?{children:h}:{}}]})}const qe=(e=[])=>{let r={};return e.forEach(t=>{const n={...t};if(!n||!n.key)return;const i=n.children||[];r[He(n.key)]={...n},r[n.key]={...n},i&&(r={...r,...qe(i)})}),r},Jt=(e=[],r)=>e.filter(t=>{if(t==="/"&&r==="/")return!0;if(t!=="/"&&t!=="/*"&&t){const n=He(t);return Zt.match(n,{end:!1})(r)}return!1}).sort((t,n)=>t===r?10:n===r?-10:t.slice(1).split("/").length-n.slice(1).split("/").length),Yt=(e,r)=>{const t=G(r,"/",!0),n=qe(t),i=Object.keys(n),u=Jt(i,e);return!u||u.length<1?[]:u.map(f=>n[f]).flat(1)},{Header:Qt,Content:ke,Sider:Xt}=pe,an=()=>{const e=De(),{t:r}=me(),{pathname:t}=tr(),n=he(m=>{var N;return(N=m.currentUser)==null?void 0:N.permissions}),{isDark:i}=Er(),[u,f]=y.useState(!1),[h,b]=y.useState(),[j,v]=y.useState([]),_=y.useMemo(()=>G({data:ye,t:r,userPerms:n??[]}),[n,r]),S=y.useMemo(()=>Yt(t,{data:ye,t:r,userPerms:n??[]}),[t,r,n]);y.useEffect(()=>{b(S.map(m=>m.key)),v(m=>Bt([...m,...S.map(N=>N.key)]))},[S]);const A=y.useMemo(()=>S.map(m=>({key:m.key,title:m.label})),[S]),k=y.useMemo(()=>({menus:_,matchedMenus:S,breadcrumbs:A}),[_,S,A]),D=({key:m})=>{e(`${m}`)},P=()=>{f(!u)};return p.jsx(dr.Provider,{value:k,children:p.jsxs(pe,{className:"h-screen",children:[p.jsxs(Qt,{className:"flex h-14 justify-between border-b border-gray-950/5 px-5 dark:border-white/10",children:[p.jsxs("div",{className:"flex items-center gap-2 text-xl font-medium",children:[p.jsx(ur,{className:"size-8"}),p.jsx("span",{children:"Metis Plus"})]}),p.jsxs("div",{className:"flex items-center gap-4",children:[p.jsx(Kt,{}),p.jsx(ir,{}),p.jsx(Ft,{})]})]}),p.jsx(ke,{children:p.jsxs(pe,{className:"h-full",children:[p.jsxs(Xt,{width:288,collapsed:u,className:"border-r border-gray-950/5 bg-transparent dark:border-white/10",children:[p.jsx(fr,{theme:i?"dark":"light",mode:"inline",selectedKeys:h,openKeys:j,items:_,onClick:D,onOpenChange:m=>v(m),className:{root:"bg-transparent",sub:{inner:"dark:hover:bg-gray-900"},item:({selected:m})=>({inner:B("dark:hover:bg-gray-900",m&&"dark:bg-gray-900")})}}),p.jsx(Ie,{title:r(u?"sidebar.tips.expand":"sidebar.tips.collapse"),children:p.jsx(nr,{type:"text",icon:p.jsx(Rr,{className:"size-5"}),size:"small",onClick:P,className:"text-text-tertiary absolute right-5 bottom-4"})})]}),p.jsx(ke,{className:"bg-gray-50 dark:bg-transparent",children:p.jsxs(cr,{children:[p.jsx("div",{className:"min-h-[calc(100%-3rem)] p-6",children:p.jsx(ar,{})}),p.jsx(lr,{})]})})]})})]})})};export{an as default};
